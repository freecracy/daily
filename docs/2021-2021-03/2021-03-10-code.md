# 2021年03月10日 code
<a href="https://toutiao.io/k/1d2mnjh">职场：3 天准备 5 天面试，跳槽完成</a><br /><a href="https://toutiao.io/k/556xuh7">通知 & 告警治理（降噪）的 7 种方法</a><br /><a href="https://toutiao.io/k/1a67fbw">Spring 如何创建 bean 对象？</a><br /><a href="https://toutiao.io/k/vmimc5g">聊聊 IT 技术人的知识体系</a><br /><a href="https://toutiao.io/k/pbf0cqj">架构设计笔记（八）：详细方案设计</a><br /><a href="https://toutiao.io/k/5v7yo5t">Linux 文件 I/O 进化史（二）：mmap</a><br /><a href="https://toutiao.io/k/xxixvp3">推荐书单 4.0：测试工程师破局之路</a><br /><a href="https://toutiao.io/k/7hmi0dw">图解设计模式</a><br /><a href="https://toutiao.io/k/ams28hi">Chrome OS 超便捷安装指南</a><br /><a href="https://toutiao.io/k/m8kwjbu">使用 Emacs 阅读邮件与 Feed 信息流</a><br /><a href="https://toutiao.io/k/cd64qao">杂谈第 36 期：大厂不要再被员工吐槽了</a><br /><a href="https://toutiao.io/k/8qvgxzj">AI 入行那些事儿（四）：最简单的机器学习模型之线性回归</a><br /><a href="https://toutiao.io/k/l90itb4">[译] 迈向完全可编程 tc 分类器 (NetdevConf，2016)</a><br /><a href="https://toutiao.io/k/5dj13zo">工具 | 一款使用 TypeScript 开发的 Web 富文本编辑器</a><br /><a href="https://toutiao.io/k/gpxv2qf">网络运营落地页风控实践</a><br /><a href="https://toutiao.io/k/s0dskwy">React 面试不完全指南</a><br /><a href="https://toutiao.io/k/0a15f6p">在 Kubernetes Pod 中如何获取客户端的真实 IP</a><br /><a href="https://toutiao.io/k/c50wq39">.NET Core dump 分析</a><br /><a href="https://toutiao.io/k/psxr0j5">上线 Python 应用仅需一条命令的开源框架：Zappa（详细教程）</a><br /><a href="https://toutiao.io/k/waxqsut">前端周刊：2021-2 期</a><br /><a href="https://toutiao.io/k/c1uc4c2">[推荐] 万字长文聊缓存（下）：应用级缓存</a><br /><a href="https://toutiao.io/k/tm4wyb0">[推荐] Redis 专题：深入解读哨兵模式</a><br /><a href="https://toutiao.io/k/j7v5pee">[推荐] 国内有哪些顶级技术团队的博客值得推荐？</a><br /><a href="https://toutiao.io/k/ep472ts">[推荐] HTTP header 中的黑科技</a><br /><a href="https://toutiao.io/k/h2vf9va">[推荐] Linux 内存管理</a><br /><a href="https://toutiao.io/k/9v93x32">[推荐] 帮助阅读源码的 8 个技巧</a><br /><a href="https://toutiao.io/k/6w82jhc">[推荐] 互联网架构演进之路</a><br /><a href="https://toutiao.io/k/jvd3wnb">[推荐] Java 实现大文件多线程下载，提速 30 倍！想学？我教你啊</a><br /><a href="https://toutiao.io/k/jfopywh">[推荐] Web 安全头号大敌 XSS 漏洞解决最佳实践</a><br /><a href="https://toutiao.io/k/rmckht1">[推荐] 硬核！漫画图解 HTTP 基础 + 面试题</a><br /><a href="https://toutiao.io/k/gheevc3">[推荐] ​程序员划水指南</a><br /><a href="https://toutiao.io/k/g6xlwp2">[推荐] 做一个很出色的程序员</a><br /><a href="https://toutiao.io/k/ix2e9ja">[推荐] 中高级前端须注意的 40 条移动端 H5 坑位指南（网易三年实践）</a><br /><a href="https://toutiao.io/k/cpf8p4q">[推荐] 流量复制方案对比：TCPCopy vs Goreplay</a><br /><a href="https://toutiao.io/k/txzl2gg">[推荐] 2021 阿里淘系工程师推荐书单</a><br /><hr /><a href="https://github.com/sherlock-project/sherlock">🔎 Hunt down social media accounts by username across social networks</a><br /><a href="https://github.com/dolthub/dolt">Dolt – It's Git for Data</a><br /><a href="https://github.com/projectdiscovery/nuclei-templates">Community curated list of templates for the nuclei engine to find a security vulnerability in the application.</a><br /><a href="https://github.com/microsoft/CSS-Exchange">Exchange Server support tools and scripts</a><br /><a href="https://github.com/ossu/computer-science">🎓 Path to a free self-taught education in Computer Science!</a><br /><a href="https://github.com/KathanP19/HowToHunt">Tutorials and Things to Do while Hunting Vulnerability.</a><br /><a href="https://github.com/ageron/handson-ml2">A series of Jupyter notebooks that walk you through the fundamentals of Machine Learning and Deep Learning in Python using Scikit-Learn, Keras and TensorFlow 2.</a><br /><a href="https://github.com/login?return_to=%2Fziglang%2Fzig">General-purpose programming language and toolchain for maintaining robust, optimal, and reusable software.</a><br /><a href="https://github.com/nasa/fprime">F' - A flight software and embedded systems framework</a><br /><a href="https://github.com/login?return_to=%2FGitSquared%2Fedex-ui">A cross-platform, customizable science fiction terminal emulator with advanced monitoring & touchscreen support.</a><br /><a href="https://github.com/epezent/implot">Advanced 2D Plotting for Dear ImGui</a><br /><a href="https://github.com/nushell/nushell">A new type of shell</a><br /><a href="https://github.com/josephmisiti/awesome-machine-learning">A curated list of awesome Machine Learning frameworks, libraries and software.</a><br /><a href="https://github.com/diasurgical/devilutionX">Diablo build for modern operating systems</a><br /><a href="https://github.com/login?return_to=%2Fplausible%2Fanalytics">Simple, open-source, lightweight (< 1 KB) and privacy-friendly web analytics alternative to Google Analytics.</a><br /><a href="https://github.com/italia/covid19-opendata-vaccini">Open Data su consegna e somministrazione dei vaccini anti COVID-19 in Italia - Commissario straordinario per l'emergenza Covid-19</a><br /><a href="https://github.com/angular/angular">One framework. Mobile & desktop.</a><br /><a href="https://github.com/SeleniumHQ/selenium">A browser automation framework and ecosystem.</a><br /><a href="https://github.com/donnemartin/system-design-primer">Learn how to design large-scale systems. Prep for the system design interview. Includes Anki flashcards.</a><br /><a href="https://github.com/qier222/YesPlayMusic">高颜值的第三方网易云播放器，支持 Windows / macOS / Linux</a><br /><a href="https://github.com/torvalds/linux">Linux kernel source tree</a><br /><a href="https://github.com/dwisiswant0/apkleaks">Scanning APK file for URIs, endpoints & secrets.</a><br /><a href="https://github.com/brillout/awesome-react-components">Curated List of React Components & Libraries.</a><br /><a href="https://github.com/abuanwar072/Chat-Messaging-App-Light-and-Dark-Theme"></a><br /><a href="https://github.com/login?return_to=%2Ffelangel%2Fbloc">A predictable state management library that helps implement the BLoC design pattern</a><br /><hr />基本计算器<br /><p>实现一个基本的计算器来计算一个简单的字符串表达式 <code>s</code> 的值。</p>

<p> </p>

<p><strong>示例 1：</strong></p>

<pre>
<strong>输入：</strong>s = "1 + 1"
<strong>输出：</strong>2
</pre>

<p><strong>示例 2：</strong></p>

<pre>
<strong>输入：</strong>s = " 2-1 + 2 "
<strong>输出：</strong>3
</pre>

<p><strong>示例 3：</strong></p>

<pre>
<strong>输入：</strong>s = "(1+(4+5+2)-3)+(6+8)"
<strong>输出：</strong>23
</pre>

<p> </p>

<p><strong>提示：</strong></p>

<ul>
	<li><code>1 <= s.length <= 3 * 10<sup>5</sup></code></li>
	<li><code>s</code> 由数字、<code>'+'</code>、<code>'-'</code>、<code>'('</code>、<code>')'</code>、和 <code>' '</code> 组成</li>
	<li><code>s</code> 表示一个有效的表达式</li>
</ul>
<br />#### 方法一：括号展开 + 栈

由于字符串除了数字与括号外，只有加号和减号两种运算符。因此，如果展开表达式中所有的括号，则得到的新表达式中，数字本身不会发生变化，只是每个数字前面的符号会发生变化。

因此，我们考虑使用一个取值为 $\{-1,+1\}$ 的整数 $\textit{sign}$ 代表「当前」的符号。根据括号表达式的性质，它的取值：
- 与字符串中当前位置的运算符有关；
- 如果当前位置处于一系列括号之内，则也与这些括号前面的运算符有关：每当遇到一个以 $-$ 号开头的括号，则意味着此后的符号都要被「翻转」。

考虑到第二点，我们需要维护一个栈 $\textit{ops}$，其中栈顶元素记录了当前位置所处的每个括号所「共同形成」的符号。例如，对于字符串 $\text{1+2+(3-(4+5))}$：
- 扫描到 $\text{1+2}$ 时，由于当前位置没有被任何括号所包含，则栈顶元素为初始值 $+1$；
- 扫描到 $\text{1+2+(3}$ 时，当前位置被一个括号所包含，该括号前面的符号为 $+$ 号，因此栈顶元素依然 $+1$；
- 扫描到 $\text{1+2+(3-(4}$ 时，当前位置被两个括号所包含，分别对应着 $+$ 号和 $-$ 号，由于 $+$ 号和 $-$ 号合并的结果为 $-$ 号，因此栈顶元素变为 $-1$。

在得到栈 $\textit{ops}$ 之后， $\textit{sign}$ 的取值就能够确定了：如果当前遇到了 $+$ 号，则更新 $\textit{sign} \leftarrow \text{ops.top()}$；如果遇到了遇到了 $-$ 号，则更新 $\textit{sign} \leftarrow -\text{ops.top()}$。

然后，每当遇到 $($ 时，都要将当前的 $\textit{sign}$ 取值压入栈中；每当遇到 $)$ 时，都从栈中弹出一个元素。这样，我们能够在扫描字符串的时候，即时地更新 $\textit{ops}$ 中的元素。

```C++ [sol1-C++]
class Solution {
public:
    int calculate(string s) {
        stack<int> ops;
        ops.push(1);
        int sign = 1;

        int ret = 0;
        int n = s.length();
        int i = 0;
        while (i < n) {
            if (s[i] == ' ') {
                i++;
            } else if (s[i] == '+') {
                sign = ops.top();
                i++;
            } else if (s[i] == '-') {
                sign = -ops.top();
                i++;
            } else if (s[i] == '(') {
                ops.push(sign);
                i++;
            } else if (s[i] == ')') {
                ops.pop();
                i++;
            } else {
                long num = 0;
                while (i < n && s[i] >= '0' && s[i] <= '9') {
                    num = num * 10 + s[i] - '0';
                    i++;
                }
                ret += sign * num;
            }
        }
        return ret;
    }
};
```

```Java [sol1-Java]
class Solution {
    public int calculate(String s) {
        Deque<Integer> ops = new LinkedList<Integer>();
        ops.push(1);
        int sign = 1;

        int ret = 0;
        int n = s.length();
        int i = 0;
        while (i < n) {
            if (s.charAt(i) == ' ') {
                i++;
            } else if (s.charAt(i) == '+') {
                sign = ops.peek();
                i++;
            } else if (s.charAt(i) == '-') {
                sign = -ops.peek();
                i++;
            } else if (s.charAt(i) == '(') {
                ops.push(sign);
                i++;
            } else if (s.charAt(i) == ')') {
                ops.pop();
                i++;
            } else {
                long num = 0;
                while (i < n && Character.isDigit(s.charAt(i))) {
                    num = num * 10 + s.charAt(i) - '0';
                    i++;
                }
                ret += sign * num;
            }
        }
        return ret;
    }
}
```

```JavaScript [sol1-JavaScript]
var calculate = function(s) {
    const ops = [1];
    let sign = 1;

    let ret = 0;
    const n = s.length;
    let i = 0;
    while (i < n) {
        if (s[i] === ' ') {
            i++;
        } else if (s[i] === '+') {
            sign = ops[ops.length - 1];
            i++;
        } else if (s[i] === '-') {
            sign = -ops[ops.length - 1];
            i++;
        } else if (s[i] === '(') {
            ops.push(sign);
            i++;
        } else if (s[i] === ')') {
            ops.pop();
            i++;
        } else {
            let num = 0;
            while (i < n && !(isNaN(Number(s[i]))) && s[i] !== ' ') {
                num = num * 10 + s[i].charCodeAt() - '0'.charCodeAt();
                i++;
            }
            ret += sign * num;
        }
    }
    return ret;
};
```

```go [sol1-Golang]
func calculate(s string) (ans int) {
    ops := []int{1}
    sign := 1
    n := len(s)
    for i := 0; i < n; {
        switch s[i] {
        case ' ':
            i++
        case '+':
            sign = ops[len(ops)-1]
            i++
        case '-':
            sign = -ops[len(ops)-1]
            i++
        case '(':
            ops = append(ops, sign)
            i++
        case ')':
            ops = ops[:len(ops)-1]
            i++
        default:
            num := 0
            for ; i < n && '0' <= s[i] && s[i] <= '9'; i++ {
                num = num*10 + int(s[i]-'0')
            }
            ans += sign * num
        }
    }
    return
}
```

```C [sol1-C]
int calculate(char* s) {
    int n = strlen(s);
    int ops[n], top = 0;
    int sign = 1;
    ops[top++] = sign;

    int ret = 0;
    int i = 0;
    while (i < n) {
        if (s[i] == ' ') {
            i++;
        } else if (s[i] == '+') {
            sign = ops[top - 1];
            i++;
        } else if (s[i] == '-') {
            sign = -ops[top - 1];
            i++;
        } else if (s[i] == '(') {
            ops[top++] = sign;
            i++;
        } else if (s[i] == ')') {
            top--;
            i++;
        } else {
            long num = 0;
            while (i < n && s[i] >= '0' && s[i] <= '9') {
                num = num * 10 + s[i] - '0';
                i++;
            }
            ret += sign * num;
        }
    }
    return ret;
}
```

**复杂度分析**

- 时间复杂度：$O(n)$，其中 $n$ 为字符串 $s$ 的长度。需要遍历字符串 $s$ 一次，计算表达式的值。

- 空间复杂度：$O(n)$，其中 $n$ 为字符串 $s$ 的长度。空间复杂度主要取决于栈的空间，栈中的元素数量不超过 $n$。

#### 备注

本题有多种基于栈这一数据结构的解法，每种解法基于相近的思路，但具有完全不同的实现方式。感兴趣的读者可以尝试阅读其他基于栈的解法，本题解不再一一列举。