# 2021年05月03日 code
<a href="https://toutiao.io/k/ok4mp6n">五一假期不想人挤人？来这里！</a><br /><a href="https://toutiao.io/k/xdsox3x">撸代码前，写下设计方案</a><br /><a href="https://toutiao.io/k/dibsh1j">[英] BPF 极简示例：动态修改 TCP 初始 RTO（超时重传时间）</a><br /><a href="https://toutiao.io/k/0f3ahmw">Kubernetes 上容器的启动顺序如何把控？</a><br /><a href="https://toutiao.io/k/5jnd1a6">深入理解 HTTP 缓存机制</a><br /><a href="https://toutiao.io/k/fjf4ers">百度 C++ 工程师的那些极限优化（内存篇）</a><br /><a href="https://toutiao.io/k/2p2dqp5">携程火车票 Flutter 最佳实践</a><br /><a href="https://toutiao.io/k/4sb61gl">如何在 ClickHouse 中快速实现 AB 表切换</a><br /><a href="https://toutiao.io/k/pft9nfv">大型前端项目架构优化探索之路之腾讯文档表格</a><br /><a href="https://toutiao.io/k/urflygs">2021 CocoaPods 新手进阶指南之仓库源</a><br /><a href="https://toutiao.io/k/2aonyjp">[推荐] 把 Redis 当作队列来用，真的合适吗？</a><br /><a href="https://toutiao.io/k/6z3uu2m">[推荐] 如何设计一个高性能的秒杀系统</a><br /><a href="https://toutiao.io/k/ti0gb8i">[推荐] Redis 进阶笔记</a><br /><a href="https://toutiao.io/k/08uadl6">[推荐] 书单丨“1 本抵 10 本” 的好书，建议收藏</a><br /><a href="https://toutiao.io/k/nrdp4oq">[推荐] 用户画像的基础、原理、方法论（模型）和应用</a><br /><a href="https://toutiao.io/k/wxrneux">[推荐] 为什么放弃 Kafka，选择 Pulsar?</a><br /><a href="https://toutiao.io/k/upefap5">[推荐] 程序员应该掌握的常用网络问题定位工具</a><br /><a href="https://toutiao.io/k/czntgsa">[推荐] 这 11 款 Chrome 神器，用起来爽到爆</a><br /><a href="https://toutiao.io/k/90vs9kg">[推荐] ClickHouse 在 Bilibili 用户行为分析的实践</a><br /><a href="https://toutiao.io/k/0iue4f4">[推荐] 2.7w 字！Java 基础面试题/知识点总结（2021 最新版）</a><br /><a href="https://toutiao.io/k/xkhaihd">[推荐] 协程切换会引起什么问题</a><br /><a href="https://toutiao.io/k/j7fdh6h">[推荐] 一文搞懂分布式锁的原理与实现</a><br /><hr /><a href="https://github.com/nvbn/thefuck">Magnificent app which corrects your previous console command.</a><br /><a href="https://github.com/raydium-io/raydium-ui"></a><br /><a href="https://github.com/thedevdojo/wave">Wave - The Software as a Service Starter Kit, designed to help you build the SAAS of your dreams 🚀 💰</a><br /><a href="https://github.com/chrisleekr/binance-trading-bot">Automated Binance trading bot - Buy low/Sell high with stop loss limit/Trade multiple cryptocurrencies</a><br /><a href="https://github.com/rust-lang/rust">Empowering everyone to build reliable and efficient software.</a><br /><a href="https://github.com/microsoft/PowerToys">Windows system utilities to maximize productivity</a><br /><a href="https://github.com/DIGITALCRIMINAL/OnlyFans">Scrape all the media from an OnlyFans account - Updated regularly</a><br /><a href="https://github.com/521xueweihan/HelloGitHub">分享 GitHub 上有趣、入门级的开源项目</a><br /><a href="https://github.com/tldr-pages/tldr">📚 Collaborative cheatsheets for console commands</a><br /><a href="https://github.com/AFLplusplus/LibAFL">Advanced Fuzzing Library - Slot your Fuzzer together in Rust! Scales across cores and machines. For Windows, Android, MacOS, Linux, no_std, ...</a><br /><a href="https://github.com/login?return_to=%2Fsupabase%2Fsupabase">The open source Firebase alternative. Follow to stay updated about our public Beta.</a><br /><a href="https://github.com/facebookresearch/dino">PyTorch code for Vision Transformers training with the Self-Supervised learning method DINO</a><br /><a href="https://github.com/leonardomso/33-js-concepts">📜 33 JavaScript concepts every developer should know.</a><br /><a href="https://github.com/input-output-hk/essential-cardano">Repository for the Essential Cardano list</a><br /><a href="https://github.com/login?return_to=%2Fsupabase%2Frealtime">Listen to your to PostgreSQL database in realtime via websockets. Built with Elixir.</a><br /><a href="https://github.com/commaai/openpilot">openpilot is an open source driver assistance system. openpilot performs the functions of Automated Lane Centering and Adaptive Cruise Control for over 100 supported car makes and models.</a><br /><a href="https://github.com/spaceuptech/space-cloud">Open source Firebase + Heroku to develop, scale and secure serverless apps on Kubernetes</a><br /><a href="https://github.com/mrdbourke/tensorflow-deep-learning">All course materials for the Zero to Mastery Deep Learning with TensorFlow course.</a><br /><a href="https://github.com/login?return_to=%2Fdani-garcia%2Fvaultwarden">Unofficial Bitwarden compatible server written in Rust, formerly known as bitwarden_rs</a><br /><a href="https://github.com/huggingface/datasets">🤗 The largest hub of ready-to-use NLP datasets for ML models with fast, easy-to-use and efficient data manipulation tools</a><br /><a href="https://github.com/vlang/v">Simple, fast, safe, compiled language for developing maintainable software. Compiles itself in <1s with zero library dependencies. https://vlang.io</a><br /><a href="https://github.com/git-tips/tips">Most commonly used git tips and tricks.</a><br /><a href="https://github.com/microsoft/Reference-Guide-For-Quantum-Computing-A-Microsoft-Garage-Project">This repository hosts the Reference Guide for Quantum Computing, a Microsoft Garage project</a><br /><a href="https://github.com/ericaltendorf/plotman">Chia plotting manager</a><br /><a href="https://github.com/popcorn-official/popcorn-desktop">Popcorn Time is a multi-platform, free software BitTorrent client that includes an integrated media player ( Windows / Mac / Linux ) A Butter-Project Fork</a><br /><hr />整数反转<br /><p>给你一个 32 位的有符号整数 <code>x</code> ，返回将 <code>x</code> 中的数字部分反转后的结果。</p>

<p>如果反转后整数超过 32 位的有符号整数的范围 <code>[−2<sup>31</sup>,  2<sup>31 </sup>− 1]</code> ，就返回 0。</p>
<strong>假设环境不允许存储 64 位整数（有符号或无符号）。</strong>

<p> </p>

<p><strong>示例 1：</strong></p>

<pre>
<strong>输入：</strong>x = 123
<strong>输出：</strong>321
</pre>

<p><strong>示例 2：</strong></p>

<pre>
<strong>输入：</strong>x = -123
<strong>输出：</strong>-321
</pre>

<p><strong>示例 3：</strong></p>

<pre>
<strong>输入：</strong>x = 120
<strong>输出：</strong>21
</pre>

<p><strong>示例 4：</strong></p>

<pre>
<strong>输入：</strong>x = 0
<strong>输出：</strong>0
</pre>

<p> </p>

<p><strong>提示：</strong></p>

<ul>
	<li><code>-2<sup>31</sup> <= x <= 2<sup>31</sup> - 1</code></li>
</ul>
<br />#### 方法一：数学

**思路**

记 $\textit{rev}$ 为翻转后的数字，为完成翻转，我们可以重复「弹出」$x$ 的末尾数字，将其「推入」$\textit{rev}$ 的末尾，直至 $x$ 为 $0$。

要在没有辅助栈或数组的帮助下「弹出」和「推入」数字，我们可以使用如下数学方法：

```cpp
// 弹出 x 的末尾数字 digit
digit = x % 10
x /= 10

// 将数字 digit 推入 rev 末尾
rev = rev * 10 + digit
```

题目需要判断反转后的数字是否超过 $32$ 位有符号整数的范围 $[-2^{31},2^{31}-1]$，例如 $x=2123456789$ 反转后的 $\textit{rev}=9876543212>2^{31}-1=2147483647$，超过了 $32$ 位有符号整数的范围。

因此我们需要在「推入」数字之前，判断是否满足 

$$-2^{31}\le\textit{rev}\cdot10+\textit{digit}\le2^{31}-1$$

若该不等式不成立则返回 $0$。

但是题目要求不允许使用 $64$ 位整数，即运算过程中的数字必须在 $32$ 位有符号整数的范围内，因此我们不能直接按照上述式子计算，需要另寻他路。

考虑 $x>0$ 的情况，记 $\textit{INT\_MAX}=2^{31}-1=2147483647$，由于

$$
\begin{aligned}
\textit{INT\_MAX}&=\lfloor\dfrac{\textit{INT\_MAX}}{10}\rfloor\cdot10+(\textit{INT\_MAX}\bmod10)\\
&=\lfloor\dfrac{\textit{INT\_MAX}}{10}\rfloor\cdot10+7
\end{aligned}
$$

则不等式

$$\textit{rev}\cdot10+\textit{digit}\le\textit{INT\_MAX}$$

等价于

$$\textit{rev}\cdot10+\textit{digit}\le\lfloor\dfrac{\textit{INT\_MAX}}{10}\rfloor\cdot10+7$$

移项得

$$(\textit{rev}-\lfloor\dfrac{\textit{INT\_MAX}}{10}\rfloor)\cdot10\le7-\textit{digit}$$

讨论该不等式成立的条件：

若 $\textit{rev}>\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$，由于 $\textit{digit}\ge0$，不等式不成立。
若 $\textit{rev}=\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$，当且仅当 $\textit{digit}\le7$ 时，不等式成立。
若 $\textit{rev}<\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$，由于 $\textit{digit}\le9$，不等式成立。

注意到当 $\textit{rev}=\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$ 时若还能推入数字，则说明 $x$ 的位数与 $\textit{INT\_MAX}$ 的位数相同，且要推入的数字 $\textit{digit}$ 为 $x$ 的最高位。由于 $x$ 不超过 $\textit{INT\_MAX}$，因此 $\textit{digit}$ 不会超过 $\textit{INT\_MAX}$ 的最高位，即 $\textit{digit}\le2$。所以实际上当 $\textit{rev}=\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$ 时不等式必定成立。

因此判定条件可简化为：**当且仅当 $\textit{rev}\le\lfloor\cfrac{\textit{INT\_MAX}}{10}\rfloor$ 时，不等式成立**。

$x<0$ 的情况类似，留给读者自证，此处不再赘述。

综上所述，判断不等式

$$-2^{31}\le\textit{rev}\cdot10+\textit{digit}\le2^{31}-1$$

是否成立，可改为判断不等式

$$\lfloor\cfrac{-2^{31}}{10}\rfloor\le\textit{rev}\le\lfloor\dfrac{2^{31}-1}{10}\rfloor$$

是否成立，若不成立则返回 $0$。

**代码**

```C++ [sol1-C++]
class Solution {
public:
    int reverse(int x) {
        int rev = 0;
        while (x != 0) {
            if (rev < INT_MIN / 10 || rev > INT_MAX / 10) {
                return 0;
            }
            int digit = x % 10;
            x /= 10;
            rev = rev * 10 + digit;
        }
        return rev;
    }
};
```

```Java [sol1-Java]
class Solution {
    public int reverse(int x) {
        int rev = 0;
        while (x != 0) {
            if (rev < Integer.MIN_VALUE / 10 || rev > Integer.MAX_VALUE / 10) {
                return 0;
            }
            int digit = x % 10;
            x /= 10;
            rev = rev * 10 + digit;
        }
        return rev;
    }
}
```

```C# [sol1-C#]
public class Solution {
    public int Reverse(int x) {
        int rev = 0;
        while (x != 0) {
            if (rev < int.MinValue / 10 || rev > int.MaxValue / 10) {
                return 0;
            }
            int digit = x % 10;
            x /= 10;
            rev = rev * 10 + digit;
        }
        return rev;
    }
}
```

```go [sol1-Golang]
func reverse(x int) (rev int) {
    for x != 0 {
        if rev < math.MinInt32/10 || rev > math.MaxInt32/10 {
            return 0
        }
        digit := x % 10
        x /= 10
        rev = rev*10 + digit
    }
    return
}
```

```Python [sol1-Python3]
class Solution:
    def reverse(self, x: int) -> int:
        INT_MIN, INT_MAX = -2**31, 2**31 - 1

        rev = 0
        while x != 0:
            # INT_MIN 也是一个负数，不能写成 rev < INT_MIN // 10
            if rev < INT_MIN // 10 + 1 or rev > INT_MAX // 10:
                return 0
            digit = x % 10
            # Python3 的取模运算在 x 为负数时也会返回 [0, 9) 以内的结果，因此这里需要进行特殊判断
            if x < 0 and digit > 0:
                digit -= 10

            # 同理，Python3 的整数除法在 x 为负数时会向下（更小的负数）取整，因此不能写成 x //= 10
            x = (x - digit) // 10
            rev = rev * 10 + digit
        
        return rev
```

```C [sol1-C]
int reverse(int x) {
    int rev = 0;
    while (x != 0) {
        if (rev < INT_MIN / 10 || rev > INT_MAX / 10) {
            return 0;
        }
        int digit = x % 10;
        x /= 10;
        rev = rev * 10 + digit;
    }
    return rev;
}
```

```JavaScript [sol1-JavaScript]
var reverse = function(x) {
    let rev = 0;
    while (x !== 0) {
        const digit = x % 10;
        x = ~~(x / 10);
        rev = rev * 10 + digit;
        if (rev < Math.pow(-2, 31) || rev > Math.pow(2, 31) - 1) {
            return 0;
        }
    }
    return rev;
};
```

**复杂度分析**

- 时间复杂度：$O(\log |x|)$。翻转的次数即 $x$ 十进制的位数。

- 空间复杂度：$O(1)$。